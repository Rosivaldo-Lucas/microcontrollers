;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
;*              MODIFICA��ES PARA USO COM 12F675                   *
;*                FEITAS PELO PROF. MARDSON                        *
;*                     FEVEREIRO DE 2023                           *
;*                 BASEADO NO EXEMPLO DO LIVRO                     *
;*           Desbravando o PIC. David Jos� de Souza                *
;*-----------------------------------------------------------------*
;*   MODELO PARA O PIC 12F675                                      *
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
;*              UNIVERSIDADE FEDERAL DA PARA�BA			   *
;*		    ENGENHARIA DE COMPUTA��O			   *
;*								   *
;*		        MICROCONTROLADORES			   *
;*								   *
;*			  ROSIVALDO LUCAS			   *
;*-----------------------------------------------------------------*
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
	
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
;*                     ARQUIVOS DE DEFINI��ES                      *
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
#INCLUDE <p12f675.inc>	;ARQUIVO PADR�O MICROCHIP PARA 12F675

	__CONFIG _BODEN_OFF & _CP_OFF & _PWRTE_ON & _WDT_OFF & _MCLRE_ON & _INTRC_OSC_NOCLKOUT

;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
;*                    PAGINA��O DE MEM�RIA                         *
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
;DEFINI��O DE COMANDOS DE USU�RIO PARA ALTERA��O DA P�GINA DE MEM�RIA
#DEFINE	BANK0	BCF STATUS,RP0	;SETA BANK 0 DE MEM�RIA
#DEFINE	BANK1	BSF STATUS,RP0	;SETA BANK 1 DE MAM�RIA

;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
;*                         VARI�VEIS                               *
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
; DEFINI��O DOS NOMES E ENDERE�OS DE TODAS AS VARI�VEIS UTILIZADAS 
; PELO SISTEMA

	CBLOCK	0x20	;ENDERE�O INICIAL DA MEM�RIA DE
					;USU�RIO
		W_TEMP		;REGISTRADORES TEMPOR�RIOS PARA USO
		STATUS_TEMP	;JUNTO �S INTERRUP��ES

		CONTA_0_5_SEGUNDOS	;VARI�VEL QUE IR� CONTAR 0.5 SEGUNDOS DE DURA��O PARA CADA SINAL DAS NOTAS
		
		;COLOQUE AQUI SUAS NOVAS VARI�VEIS
		;N�O ESQUE�A COMENT�RIOS ESCLARECEDORES

	ENDC			;FIM DO BLOCO DE DEFINI��O DE VARI�VEIS

;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
;*                        FLAGS INTERNOS                           *
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
; DEFINI��O DE TODOS OS FLAGS UTILIZADOS PELO SISTEMA

;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
;*                         CONSTANTES                              *
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
; DEFINI��O DE TODAS AS CONSTANTES UTILIZADAS PELO SISTEMA

;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
;*                           ENTRADAS                              *
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
; DEFINI��O DE TODOS OS PINOS QUE SER�O UTILIZADOS COMO ENTRADA
; RECOMENDAMOS TAMB�M COMENTAR O SIGNIFICADO DE SEUS ESTADOS (0 E 1)

;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
;*                           SA�DAS                                *
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
; DEFINI��O DE TODOS OS PINOS QUE SER�O UTILIZADOS COMO SA�DA
; RECOMENDAMOS TAMB�M COMENTAR O SIGNIFICADO DE SEUS ESTADOS (0 E 1)

;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
;*                       VETOR DE RESET                            *
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

	ORG	0x00			;ENDERE�O INICIAL DE PROCESSAMENTO
	GOTO	INICIO
	
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
;*                    IN�CIO DA INTERRUP��O                        *
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
; ENDERE�O DE DESVIO DAS INTERRUP��ES. A PRIMEIRA TAREFA � SALVAR OS
; VALORES DE "W" E "STATUS" PARA RECUPERA��O FUTURA

	ORG	0x04			;ENDERE�O INICIAL DA INTERRUP��O
	MOVWF	W_TEMP		;COPIA W PARA W_TEMP
	SWAPF	STATUS,W
	MOVWF	STATUS_TEMP	;COPIA STATUS PARA STATUS_TEMP

;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
;*                    ROTINA DE INTERRUP��O                        *
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
; AQUI SER�O ESCRITAS AS ROTINAS DE RECONHECIMENTO E TRATAMENTO DAS
; INTERRUP��ES

;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
;*                 ROTINA DE SA�DA DA INTERRUP��O                  *
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
; OS VALORES DE "W" E "STATUS" DEVEM SER RECUPERADOS ANTES DE 
; RETORNAR DA INTERRUP��O

SAI_INT
	SWAPF	STATUS_TEMP,W
	MOVWF	STATUS		;MOVE STATUS_TEMP PARA STATUS
	SWAPF	W_TEMP,F
	SWAPF	W_TEMP,W	;MOVE W_TEMP PARA W
	RETFIE

;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
;*	            	 ROTINAS E SUBROTINAS                      *
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
; CADA ROTINA OU SUBROTINA DEVE POSSUIR A DESCRI��O DE FUNCIONAMENTO
; E UM NOME COERENTE �S SUAS FUN��ES.


;FUN��O QUE TEM COMO OBJETIVO DEIXAR A PORTA GP5 EM N�VEL L�GICO BAIXO SEMPRE QUE A PORTA GP0 ESTIVER EM N�VEL L�GICO ALTO
BAIXO_GP5
	BCF	    GPIO,GP5	    ;SETA O BIT GP5 PARA N�VEL L�GICO BAIXO
	
	REPETEE
	BTFSS	    GPIO,GP0	    ;VERIFICA SE O BIT GP0 � IGUAL A ZERO, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	RETURN			    ;SE O BIT GP0 FOR ZERO, RETORNA PARA A EXECU��O DAS NOTAS
	GOTO	    REPETEE	    ;SE O BIT GP0 FOR UM, REPETE E FICA EM LOOP AT� O BIT GP0 FOR IGUAL A ZERO

;DEFINE O DELAY DAS NOTAS
	
;FUN��O DE DELAY PARA O SINAL DA NOTA D�
DELAY_NOTA_DO
	BCF	    INTCON,T0IF		    ;SETA PARA ZERO O BIT T0IF DO REGISTRADOR INTCON
	MOVLW	    .17			    ;MOVE O VALOR 17 PARA O WORK
	MOVWF	    TMR0		    ;MOVE O VALOR 17 PARA O TIMER0
	
	REPETE_DELAY_NOTA_DO
	BTFSS	    INTCON,T0IF		    ;VERIFICA SE O BIT T0IF � IGUAL A ZERO, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	GOTO	    REPETE_DELAY_NOTA_DO    ;O BIT T0IF � ZERO, ENT�O N�O TERMINOU DE CONTAR, REPETE O PROCESSO
	RETURN				    ;FINALIZA O DELAY DO SINAL D�

;FUN��O DE DELAY PARA O SINAL DA NOTA R�
DELAY_NOTA_RE
	BCF	    INTCON,T0IF		    ;SETA PARA ZERO O BIT T0IF DO REGISTRADOR INTCON
	MOVLW	    .43			    ;MOVE O VALOR 43 PARA O WORK
	MOVWF	    TMR0		    ;MOVE O VALOR 43 PARA O TIMER0
	
	REPETE_DELAY_NOTA_RE
	BTFSS	    INTCON,T0IF		    ;VERIFICA SE O BIT T0IF � IGUAL A ZERO, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	GOTO	    REPETE_DELAY_NOTA_RE    ;O BIT T0IF � ZERO, ENT�O N�O TERMINOU DE CONTAR, REPETE O PROCESSO
	RETURN				    ;FINALIZA O DELAY DO SINAL R�
	
;FUN��O DE DELAY PARA O SINAL DA NOTA MI
DELAY_NOTA_MI
	BCF	    INTCON,T0IF		    ;SETA PARA ZERO O BIT T0IF DO REGISTRADOR INTCON
	MOVLW	    .66			    ;MOVE O VALOR 66 PARA O WORK
	MOVWF	    TMR0		    ;MOVE O VALOR 66 PARA O TIMER0
	
	REPETE_DELAY_NOTA_MI
	BTFSS	    INTCON,T0IF		    ;VERIFICA SE O BIT T0IF � IGUAL A ZERO, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	GOTO	    REPETE_DELAY_NOTA_MI    ;O BIT T0IF � ZERO, ENT�O N�O TERMINOU DE CONTAR, REPETE O PROCESSO
	RETURN				    ;FINALIZA O DELAY DO SINAL MI
	
;FUN��O DE DELAY PARA O SINAL DA NOTA F�
DELAY_NOTA_FA
	BCF	    INTCON,T0IF		    ;SETA PARA ZERO O BIT T0IF DO REGISTRADOR INTCON
	MOVLW	    .77			    ;MOVE O VALOR 77 PARA O WORK
	MOVWF	    TMR0		    ;MOVE O VALOR 77 PARA O TIMER0
	
	REPETE_DELAY_NOTA_FA
	BTFSS	    INTCON,T0IF		    ;VERIFICA SE O BIT T0IF � IGUAL A ZERO, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	GOTO	    REPETE_DELAY_NOTA_FA    ;O BIT T0IF � ZERO, ENT�O N�O TERMINOU DE CONTAR, REPETE O PROCESSO
	RETURN				    ;FINALIZA O DELAY DO SINAL F�

;FUN��O DE DELAY PARA O SINAL DA NOTA SOL
DELAY_NOTA_SOL
	BCF	    INTCON,T0IF		    ;SETA PARA ZERO O BIT T0IF DO REGISTRADOR INTCON
	MOVLW	    .96			    ;MOVE O VALOR 96 PARA O WORK
	MOVWF	    TMR0		    ;MOVE O VALOR 96 PARA O TIMER0
	
	REPETE_DELAY_NOTA_SOL
	BTFSS	    INTCON,T0IF		    ;VERIFICA SE O BIT T0IF � IGUAL A ZERO, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	GOTO	    REPETE_DELAY_NOTA_SOL   ;O BIT T0IF � ZERO, ENT�O N�O TERMINOU DE CONTAR, REPETE O PROCESSO
	RETURN				    ;FINALIZA O DELAY DO SINAL SOL
	
;FUN��O DE DELAY PARA O SINAL DA NOTA L�
DELAY_NOTA_LA
	BCF	    INTCON,T0IF		    ;SETA PARA ZERO O BIT T0IF DO REGISTRADOR INTCON
	MOVLW	    .114		    ;MOVE O VALOR 114 PARA O WORK
	MOVWF	    TMR0		    ;MOVE O VALOR 114 PARA O TIMER0
	
	REPETE_DELAY_NOTA_LA
	BTFSS	    INTCON,T0IF		    ;VERIFICA SE O BIT T0IF � IGUAL A ZERO, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	GOTO	    REPETE_DELAY_NOTA_LA    ;O BIT T0IF � ZERO, ENT�O N�O TERMINOU DE CONTAR, REPETE O PROCESSO
	RETURN				    ;FINALIZA O DELAY DO SINAL L�

;FUN��O DE DELAY PARA O SINAL DA NOTA SI
DELAY_NOTA_SI
	BCF	    INTCON,T0IF		    ;SETA PARA ZERO O BIT T0IF DO REGISTRADOR INTCON
	MOVLW	    .129		    ;MOVE O VALOR 129 PARA O WORK
	MOVWF	    TMR0		    ;MOVE O VALOR 129 PARA O TIMER0
	
	REPETE_DELAY_NOTA_SI
	BTFSS	    INTCON,T0IF		    ;VERIFICA SE O BIT T0IF � IGUAL A ZERO, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	GOTO	    REPETE_DELAY_NOTA_SI    ;O BIT T0IF � ZERO, ENT�O N�O TERMINOU DE CONTAR, REPETE O PROCESSO
	RETURN				    ;FINALIZA O DELAY DO SINAL SI

;DEFINE OS SINAIS DAS NOTAS

;VALORES PARA A VARI�VEL CONTA_0_5_SEGUNDOS FORAM OBTIDOS EXPERIMENTALMENTE. REALIZANDO TESTES E VERIFICANDO
;NO STOPWATCH SE A EXECU��O DE CADA NOTA TINHA DURA��O PR�XIMA DE 0.5 SEGUNDOS
	
;EXECUTA O SINAL DA NOTA D�
NOTA_DO
	MOVLW	    .130		    ;MOVE O VALOR 130 PARA O WORK
	MOVWF	    CONTA_0_5_SEGUNDOS	    ;MOVE O VALOR DE WORK PARA CONTA_0_5_SEGUNDOS
	
	REPETE_NOTA_DO
	BTFSC	    GPIO,GP0		    ;VERIFICA SE O BIT GP0 � IGUAL A UM, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	RETURN
	
	BSF	    GPIO,GP5		    ;SETA O BIT GP5 PARA N�VEL L�GICO ALTO
	CALL	    DELAY_NOTA_DO	    ;CHAMA DELAY DO SINAL D�
	BCF	    GPIO,GP5		    ;SETA O BIT GP5 PARA N�VEL L�GICO BAIXO
	CALL	    DELAY_NOTA_DO	    ;CHAMA DELAY DO SINAL D�
	
	DECFSZ	    CONTA_0_5_SEGUNDOS,F    ;DECREMENTA E ARMAZENA O VALOR NA VARI�VEL, SE FOR ZERO, SAI DA FUN��O, J� PASSOU 0.5 SEGUNDOS
	GOTO	    REPETE_NOTA_DO	    ;REPETE A CONTAGEM, N�O SE PASSOU 0.5 SEGUNDOS
	RETURN				    ;RETORNA, J� SE PASSOU 0.5 SEGUNDOS

;EXECUTA O SINAL DA NOTA R�
NOTA_RE
	MOVLW	    .148		    ;MOVE O VALOR 148 PARA O WORK
	MOVWF	    CONTA_0_5_SEGUNDOS	    ;MOVE O VALOR DE WORK PARA CONTA_0_5_SEGUNDOS
	
	REPETE_NOTA_RE
	BTFSC	    GPIO,GP0		    ;VERIFICA SE O BIT GP0 � IGUAL A UM, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	RETURN
	
	BSF	    GPIO,GP5		    ;SETA O BIT GP5 PARA N�VEL L�GICO ALTO
	CALL	    DELAY_NOTA_RE	    ;CHAMA DELAY DO SINAL R�
	BCF	    GPIO,GP5		    ;SETA O BIT GP5 PARA N�VEL L�GICO BAIXO
	CALL	    DELAY_NOTA_RE	    ;CHAMA DELAY DO SINAL R�
	
	DECFSZ	    CONTA_0_5_SEGUNDOS,F    ;DECREMENTA E ARMAZENA O VALOR NA VARI�VEL, SE FOR ZERO, SAI DA FUN��O, J� PASSOU 0.5 SEGUNDOS
	GOTO	    REPETE_NOTA_RE	    ;REPETE A CONTAGEM, N�O SE PASSOU 0.5 SEGUNDOS
	RETURN				    ;RETORNA, J� SE PASSOU 0.5 SEGUNDOS

;EXECUTA O SINAL DA NOTA MI
NOTA_MI
	MOVLW	    .164		    ;MOVE O VALOR 164 PARA O WORK
	MOVWF	    CONTA_0_5_SEGUNDOS	    ;MOVE O VALOR DE WORK PARA CONTA_0_5_SEGUNDOS
	
	REPETE_NOTA_MI
	BTFSC	    GPIO,GP0		    ;VERIFICA SE O BIT GP0 � IGUAL A UM, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	RETURN
	
	BSF	    GPIO,GP5		    ;SETA O BIT GP5 PARA N�VEL L�GICO ALTO
	CALL	    DELAY_NOTA_MI	    ;CHAMA DELAY DO SINAL MI
	BCF	    GPIO,GP5		    ;SETA O BIT GP5 PARA N�VEL L�GICO BAIXO
	CALL	    DELAY_NOTA_MI	    ;CHAMA DELAY DO SINAL MI
	
	DECFSZ	    CONTA_0_5_SEGUNDOS,F    ;DECREMENTA E ARMAZENA O VALOR NA VARI�VEL, SE FOR ZERO, SAI DA FUN��O, J� PASSOU 0.5 SEGUNDOS
	GOTO	    REPETE_NOTA_MI	    ;REPETE A CONTAGEM, N�O SE PASSOU 0.5 SEGUNDOS
	RETURN				    ;RETORNA, J� SE PASSOU 0.5 SEGUNDOS
	
;EXECUTA O SINAL DA NOTA F�
NOTA_FA
	MOVLW	    .173		    ;MOVE O VALOR 173 PARA O WORK
	MOVWF	    CONTA_0_5_SEGUNDOS	    ;MOVE O VALOR DE WORK PARA CONTA_0_5_SEGUNDOS
	
	REPETE_NOTA_FA
	BTFSC	    GPIO,GP0		    ;VERIFICA SE O BIT GP0 � IGUAL A UM, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	RETURN
	
	BSF	    GPIO,GP5		    ;SETA O BIT GP5 PARA N�VEL L�GICO ALTO
	CALL	    DELAY_NOTA_FA	    ;CHAMA DELAY DO SINAL F�
	BCF	    GPIO,GP5		    ;SETA O BIT GP5 PARA N�VEL L�GICO BAIXO
	CALL	    DELAY_NOTA_FA	    ;CHAMA DELAY DO SINAL F�
	
	DECFSZ	    CONTA_0_5_SEGUNDOS,F    ;DECREMENTA E ARMAZENA O VALOR NA VARI�VEL, SE FOR ZERO, SAI DA FUN��O, J� PASSOU 0.5 SEGUNDOS
	GOTO	    REPETE_NOTA_FA	    ;REPETE A CONTAGEM, N�O SE PASSOU 0.5 SEGUNDOS
	RETURN				    ;RETORNA, J� SE PASSOU 0.5 SEGUNDOS
	
;EXECUTA O SINAL DA NOTA SOL
NOTA_SOL
	MOVLW	    .195		    ;MOVE O VALOR 195 PARA O WORK
	MOVWF	    CONTA_0_5_SEGUNDOS	    ;MOVE O VALOR DE WORK PARA CONTA_0_5_SEGUNDOS
	
	REPETE_NOTA_SOL
	BTFSC	    GPIO,GP0		    ;VERIFICA SE O BIT GP0 � IGUAL A UM, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	RETURN
	
	BSF	    GPIO,GP5		    ;SETA O BIT GP5 PARA N�VEL L�GICO ALTO
	CALL	    DELAY_NOTA_SOL	    ;CHAMA DELAY DO SINAL SOL
	BCF	    GPIO,GP5		    ;SETA O BIT GP5 PARA N�VEL L�GICO BAIXO
	CALL	    DELAY_NOTA_SOL	    ;CHAMA DELAY DO SINAL SOL
	
	DECFSZ	    CONTA_0_5_SEGUNDOS,F    ;DECREMENTA E ARMAZENA O VALOR NA VARI�VEL, SE FOR ZERO, SAI DA FUN��O, J� PASSOU 0.5 SEGUNDOS
	GOTO	    REPETE_NOTA_SOL	    ;REPETE A CONTAGEM, N�O SE PASSOU 0.5 SEGUNDOS
	RETURN				    ;RETORNA, J� SE PASSOU 0.5 SEGUNDOS
	
;EXECUTA O SINAL DA NOTA L�
NOTA_LA
	MOVLW	    .220		    ;MOVE O VALOR 220 PARA O WORK
	MOVWF	    CONTA_0_5_SEGUNDOS	    ;MOVE O VALOR DE WORK PARA CONTA_0_5_SEGUNDOS
	
	REPETE_NOTA_LA
	BTFSC	    GPIO,GP0		    ;VERIFICA SE O BIT GP0 � IGUAL A UM, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	RETURN
	
	BSF	    GPIO,GP5		    ;SETA O BIT GP5 PARA N�VEL L�GICO ALTO
	CALL	    DELAY_NOTA_LA	    ;CHAMA DELAY DO SINAL L�
	BCF	    GPIO,GP5		    ;SETA O BIT GP5 PARA N�VEL L�GICO BAIXO
	CALL	    DELAY_NOTA_LA	    ;CHAMA DELAY DO SINAL L�
	
	DECFSZ	    CONTA_0_5_SEGUNDOS,F    ;DECREMENTA E ARMAZENA O VALOR NA VARI�VEL, SE FOR ZERO, SAI DA FUN��O, J� PASSOU 0.5 SEGUNDOS
	GOTO	    REPETE_NOTA_LA	    ;REPETE A CONTAGEM, N�O SE PASSOU 0.5 SEGUNDOS
	RETURN				    ;RETORNA, J� SE PASSOU 0.5 SEGUNDOS

;EXECUTA O SINAL DA NOTA SI
NOTA_SI
	MOVLW	    .245		    ;MOVE O VALOR 245 PARA O WORK
	MOVWF	    CONTA_0_5_SEGUNDOS	    ;MOVE O VALOR DE WORK PARA CONTA_0_5_SEGUNDOS
	
	REPETE_NOTA_SI
	BTFSC	    GPIO,GP0		    ;VERIFICA SE O BIT GP0 � IGUAL A UM, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	RETURN
	
	BSF	    GPIO,GP5		    ;SETA O BIT GP5 PARA N�VEL L�GICO ALTO
	CALL	    DELAY_NOTA_SI	    ;CHAMA DELAY DO SINAL SI
	BCF	    GPIO,GP5		    ;SETA O BIT GP5 PARA N�VEL L�GICO BAIXO
	CALL	    DELAY_NOTA_SI	    ;CHAMA DELAY DO SINAL SI
	
	DECFSZ	    CONTA_0_5_SEGUNDOS,F    ;DECREMENTA E ARMAZENA O VALOR NA VARI�VEL, SE FOR ZERO, SAI DA FUN��O, J� PASSOU 0.5 SEGUNDOS
	GOTO	    REPETE_NOTA_SI	    ;REPETE A CONTAGEM, N�O SE PASSOU 0.5 SEGUNDOS
	RETURN				    ;RETORNA, J� SE PASSOU 0.5 SEGUNDOS

;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
;*                     INICIO DO PROGRAMA                          *
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
	
INICIO
	BANK1			    ;ALTERA PARA O BANCO 1
	MOVLW	B'00001001'	    ;CONFIGURA TODAS AS PORTAS DO GPIO (PINOS)
	MOVWF	TRISIO		    ;COMO SA�DAS
	CLRF	ANSEL		    ;DEFINE PORTAS COMO Digital I/O
	MOVLW	B'00000010'
	MOVWF	OPTION_REG	    ;DEFINE OP��ES DE OPERA��O
	MOVLW	B'00000000'
	MOVWF	INTCON		    ;DEFINE OP��ES DE INTERRUP��ES
	BANK0			    ;RETORNA PARA O BANCO
	MOVLW	B'00000111'
	MOVWF	CMCON		    ;DEFINE O MODO DE OPERA��O DO COMPARADOR ANAL�GICO

;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
;*                     INICIALIZA��O DAS VARI�VEIS                 *
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
;*                     ROTINA PRINCIPAL                            *
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
MAIN

	;CORPO DA ROTINA PRINCIPAL

	BTFSS	    GPIO,GP0	    ;VERIFICA SE O BIT GP0 � IGUAL A ZERO, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	CALL	    NOTA_DO	    ;CHAMA A FUN��O QUE EXECUTA A NOTA D�
	CALL	    BAIXO_GP5	    ;CHAMA A FUN��O QUE DEIXA O BIT GP5 EM N�VEL L�GICO BAIXO
	CALL	    NOTA_RE	    ;CHAMA A FUN��O QUE EXECUTA A NOTA R�
	BTFSS	    GPIO,GP0	    ;VERIFICA SE O BIT GP0 � IGUAL A ZERO, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	CALL	    NOTA_MI	    ;CHAMA A FUN��O QUE EXECUTA A NOTA MI
	CALL	    BAIXO_GP5	    ;CHAMA A FUN��O QUE DEIXA O BIT GP5 EM N�VEL L�GICO BAIXO
	BTFSS	    GPIO,GP0	    ;VERIFICA SE O BIT GP0 � IGUAL A ZERO, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	CALL	    NOTA_FA	    ;CHAMA A FUN��O QUE EXECUTA A NOTA F�
	CALL	    BAIXO_GP5	    ;CHAMA A FUN��O QUE DEIXA O BIT GP5 EM N�VEL L�GICO BAIXO
	BTFSS	    GPIO,GP0	    ;VERIFICA SE O BIT GP0 � IGUAL A ZERO, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	CALL	    NOTA_SOL	    ;CHAMA A FUN��O QUE EXECUTA A NOTA SOL
	CALL	    BAIXO_GP5	    ;CHAMA A FUN��O QUE DEIXA O BIT GP5 EM N�VEL L�GICO BAIXO
	BTFSS	    GPIO,GP0	    ;VERIFICA SE O BIT GP0 � IGUAL A ZERO, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	CALL	    NOTA_LA	    ;CHAMA A FUN��O QUE EXECUTA A NOTA L�
	CALL	    BAIXO_GP5	    ;CHAMA A FUN��O QUE DEIXA O BIT GP5 EM N�VEL L�GICO BAIXO
	BTFSS	    GPIO,GP0	    ;VERIFICA SE O BIT GP0 � IGUAL A ZERO, SE FOR, EXECUTA A PR�XIMA LINHA, SE N�O, PULA A PR�XIMA LINHA
	CALL	    NOTA_SI	    ;CHAMA A FUN��O QUE EXECUTA A NOTA SI
	CALL	    BAIXO_GP5	    ;CHAMA A FUN��O QUE DEIXA O BIT GP5 EM N�VEL L�GICO BAIXO
	
	GOTO	MAIN

;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
;*                       FIM DO PROGRAMA                           *
;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

	END
